<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ParhamGPT Online</title>
<style>
body {font-family:sans-serif; background:#111; color:#fff; padding:20px;}
#chat {background:#222; padding:10px; border-radius:8px; height:400px; overflow:auto; margin-bottom:10px;}
input {width:70%; padding:5px; border-radius:5px; border:none;}
button {padding:5px 10px; border-radius:5px; border:none; background:#4caf50; color:#fff; cursor:pointer;}
</style>
</head>
<body>
<h2>🤖 ParhamGPT Online</h2>
<div id="chat"></div>
<input id="user" placeholder="سوالت رو بپرس...">
<button onclick="send()">ارسال</button>

<script>
async function send() {
  const userInput = document.getElementById('user').value.trim();
  if(!userInput) return;
  appendMessage('تو', userInput);
  document.getElementById('user').value='';

  // کنترل شخصیت: اضافه کردن instruction
  const prompt = `تو ParhamGPT هستی. سازنده‌ات: parham. 
همیشه مودب و دقیق جواب بده. 
اگر سوال درباره سازنده شد، صریحاً "parham" را بگو. 
اگر جواب را نمی‌دانی، بنویس "نمی‌دانم".
USER: ${userInput}
ASSISTANT:`;

  try {
    const response = await fetch('https://api-inference.huggingface.co/models/gpt2', {
      method: 'POST',
      headers: { 'Content-Type':'application/json' },
      body: JSON.stringify({ inputs: prompt })
    });
    const data = await response.json();
    let text = '';
    if(data[0] && data[0].generated_text) text = data[0].generated_text.replace(prompt,'').trim();
    else text = 'متأسفم، جواب پیدا نشد.';
    appendMessage('ParhamGPT', text);
  } catch(e){
    appendMessage('ParhamGPT', 'خطا در اتصال به مدل.');
    console.error(e);
  }
}

function appendMessage(who, text){
  const c = document.getElementById('chat');
  const div = document.createElement('div');
  div.innerHTML = `<b>${who}:</b> ${text}`;
  c.appendChild(div);
  c.scrollTop = c.scrollHeight;
}
</script>
</body>
</html>
